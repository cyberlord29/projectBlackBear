!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("d3-array")):"function"==typeof define&&define.amd?define(["exports","d3-array"],r):r(n.fc=n.fc||{},n.d3)}(this,function(n,r){"use strict";function t(n){return n}function e(n){}function u(n){return"function"==typeof n?n:function(){return n}}function o(n){return"number"==typeof n&&isNaN(n)?void 0:n}var i=function(n,r,t){var e=r[t];if("function"!=typeof e)throw new Error("Attempt to rebind "+t+" which isn't a function on the source object");return function(){for(var t=arguments.length,u=Array(t),o=0;o<t;o++)u[o]=arguments[o];var i=e.apply(r,u);return i===r?n:i}},a=function(n,r){for(var t=arguments.length,e=Array(t>2?t-2:0),u=2;u<t;u++)e[u-2]=arguments[u];var o=!0,a=!1,c=void 0;try{for(var l,f=e[Symbol.iterator]();!(o=(l=f.next()).done);o=!0){var d=l.value;n[d]=i(n,r,d)}}catch(n){a=!0,c=n}finally{try{!o&&f.return&&f.return()}finally{if(a)throw c}}return n},c=function(n){return function(r){return n.reduce(function(n,r){return n&&r(n)},r)}},l=function(n,r){for(var t=arguments.length,e=Array(t>2?t-2:0),u=2;u<t;u++)e[u-2]=arguments[u];var o=c(e),a=!0,l=!1,f=void 0;try{for(var d,v=Object.keys(r)[Symbol.iterator]();!(a=(d=v.next()).done);a=!0){var h=d.value,p=o(h);p&&(n[p]=i(n,r,h))}}catch(n){l=!0,f=n}finally{try{!a&&v.return&&v.return()}finally{if(l)throw f}}return n},f=function(n){return function(r){return n[r]}},d=function(){var n=function(){return 10},r=e,o=t,i=function(n){return null!=n},a=function(t){var e=n.apply(this,arguments),u=t.slice(0,e).map(o);return t.map(function(n,t){return t>=e&&(u.shift(),u.push(o(n,t))),t<e-1||u.some(function(n){return!i(n)})?r(void 0,t):r(u,t)})};return a.period=function(){return arguments.length?(n=u(arguments.length<=0?void 0:arguments[0]),a):n},a.accumulator=function(){return arguments.length?(r=arguments.length<=0?void 0:arguments[0],a):r},a.defined=function(){return arguments.length?(i=arguments.length<=0?void 0:arguments[0],a):i},a.value=function(){return arguments.length?(o=arguments.length<=0?void 0:arguments[0],a):o},a},v=function(){var n=2,t=d().accumulator(function(t){var e=t&&r.deviation(t),u=t&&r.mean(t);return{average:u,upper:o(u+n*e),lower:o(u-n*e)}}),e=function(n){return t(n)};return e.multiplier=function(){return arguments.length?(n=arguments.length<=0?void 0:arguments[0],e):n},a(e,t,"period","value"),e},h=function(){var n=t,e=function(){return 9},i=function(n){var t=[];return function(e){var u=void 0;return t.length<n&&(null!=e?t.push(e):t=[]),t.length>=n&&(u=r.mean(t)),u}},a=function(r){var t=e.apply(this,arguments),u=2/(t+1),a=i(t),c=void 0;return r.map(function(r,t){var e=n(r,t);return c=void 0===c?a(e):e*u+(1-u)*c,o(c)})};return a.period=function(){return arguments.length?(e=u(arguments.length<=0?void 0:arguments[0]),a):e},a.value=function(){return arguments.length?(n=arguments.length<=0?void 0:arguments[0],a):n},a},p=function(){var n=t,e=h().period(12),u=h().period(26),o=h().period(9),i=function(t){e.value(n),u.value(n);var i=r.zip(e(t),u(t)).map(function(n){return void 0!==n[0]&&void 0!==n[1]?n[0]-n[1]:void 0}),a=o(i);return r.zip(i,a).map(function(n){return{macd:n[0],signal:n[1],divergence:void 0!==n[0]&&void 0!==n[1]?n[0]-n[1]:void 0}})};return i.value=function(){return arguments.length?(n=arguments.length<=0?void 0:arguments[0],i):n},l(i,e,f({period:"fastPeriod"})),l(i,u,f({period:"slowPeriod"})),l(i,o,f({period:"signalPeriod"})),i},g=function(){function n(n,r){var t=[],e=!0,u=!1,o=void 0;try{for(var i,a=n[Symbol.iterator]();!(e=(i=a.next()).done)&&(t.push(i.value),!r||t.length!==r);e=!0);}catch(n){u=!0,o=n}finally{try{!e&&a.return&&a.return()}finally{if(u)throw o}}return t}return function(r,t){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return n(r,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),y=function(n){if(Array.isArray(n)){for(var r=0,t=Array(n.length);r<n.length;r++)t[r]=n[r];return t}return Array.from(n)},s=function(){var n=d().period(14),t=function(n,r){return r+(n[n.length-1]-r)/n.length},e=function(n){var r=g(n,2),t=r[0],e=r[1];return t<e?0:t-e},u=function(n){var r=g(n,2),t=r[0],e=r[1];return t>e?0:e-t},i=function(n,e){return void 0!==e?t(n,e):r.mean(n)},c=function(){var n=void 0,t=void 0,a=void 0;return function(c){if(!c)return void(void 0!==n&&(n=NaN));if(void 0===n)return void(n=c[0]);var l=r.pairs([n].concat(y(c)));return t=i(l.map(e),t),a=i(l.map(u),a),o(100-100/(1+(isNaN(n)?NaN:a/t)))}},l=function(r){var t=c();return n.accumulator(t),n(r)};return a(l,n,"period","value"),l},m=function(){var n=d().accumulator(function(n){return n&&r.mean(n)}),t=function(r){return n(r)};return a(t,n,"period","value"),t},w=function(){var n=function(n,r){return n.close},t=function(n,r){return n.high},e=function(n,r){return n.low},u=d().period(5).defined(function(r){return null!=n(r)&&null!=t(r)&&null!=e(r)}).accumulator(function(u){var i=u&&r.max(u,t),a=u&&r.min(u,e);return o(u&&100*(n(u[u.length-1])-a)/(i-a))}),i=m().period(3),a=function(n){var r=u(n),t=i(r);return r.map(function(n,r){return{k:n,d:t[r]}})};return a.closeValue=function(){return arguments.length?(n=arguments.length<=0?void 0:arguments[0],a):n},a.highValue=function(){return arguments.length?(t=arguments.length<=0?void 0:arguments[0],a):t},a.lowValue=function(){return arguments.length?(e=arguments.length<=0?void 0:arguments[0],a):e},l(a,u,f({period:"kPeriod"})),l(a,i,f({period:"dPeriod"})),a},b=function(){var n=function(n,r){return n.volume},r=function(n,r){return n.close},t=h().period(13),e=d().period(2).defined(function(t){return null!=r(t)&&null!=n(t)}).accumulator(function(t){return t&&o((r(t[1])-r(t[0]))*n(t[1]))}),u=function(n){var r=e(n);return t(r)};return u.volumeValue=function(){return arguments.length?(n=arguments.length<=0?void 0:arguments[0],u):n},u.closeValue=function(){return arguments.length?(r=arguments.length<=0?void 0:arguments[0],u):r},a(u,t,"period"),u},A=function(){var n=.1,r=t,e=function(t){return t.map(function(t){return{lower:o(r(t)*(1-n)),upper:o(r(t)*(1+n))}})};return e.factor=function(){return arguments.length?(n=arguments.length<=0?void 0:arguments[0],e):n},e.value=function(){return arguments.length?(r=arguments.length<=0?void 0:arguments[0],e):r},e},x=function(){var n=function(n,r){return n.close},t=function(n,r){return n.high},e=function(n,r){return n.low},u=h().period(13),i=function(i){return u.value(n),r.zip(i,u(i)).map(function(n){return{bullPower:o(t(n[0])-n[1]),bearPower:o(e(n[0])-n[1])}})};return i.closeValue=function(){return arguments.length?(n=arguments.length<=0?void 0:arguments[0],i):n},i.highValue=function(){return arguments.length?(t=arguments.length<=0?void 0:arguments[0],i):t},i.lowValue=function(){return arguments.length?(e=arguments.length<=0?void 0:arguments[0],i):e},a(i,u,"period"),i};n.indicatorBollingerBands=v,n.indicatorExponentialMovingAverage=h,n.indicatorMacd=p,n.indicatorRelativeStrengthIndex=s,n.indicatorStochasticOscillator=w,n.indicatorForceIndex=b,n.indicatorEnvelope=A,n.indicatorElderRay=x,n.indicatorMovingAverage=m,Object.defineProperty(n,"__esModule",{value:!0})});